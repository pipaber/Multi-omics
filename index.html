<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Piero Palacios Bernuy">
<meta name="dcterms.date" content="2024-05-01">
<meta name="keywords" content="Genomic Ranges, Omics, Bioconductor">

<title>Integrative Analysis of Multi-omic Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<meta name="citation_title" content="Integrative Analysis of Multi-omic Data">
<meta name="citation_abstract" content="This document is part of a series of the analysis of Omics data. Especifically, here is showed how to analyze bulk RNA-Seq data with Bioconductor packages. Also, it&amp;amp;#039;s showcased how to make plots of the RNA data in the context of differentially gene expression and gene-sets.
">
<meta name="citation_keywords" content="Genomic Ranges,Omics,Bioconductor">
<meta name="citation_author" content="Piero Palacios Bernuy">
<meta name="citation_publication_date" content="2024-05-01">
<meta name="citation_cover_date" content="2024-05-01">
<meta name="citation_year" content="2024">
<meta name="citation_online_date" content="2024-05-01">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="An open source portfolio">
<meta name="citation_reference" content="citation_title=Strategies for the development of volcanic hazard maps in monogenetic volcanic fields: The example of La Palma (Canary Islands);,citation_author=José Marrero;,citation_author=Alicia García;,citation_author=Manuel Berrocoso;,citation_author=Ángeles Llinares;,citation_author=Antonio Rodríguez-Losada;,citation_author=R. Ortiz;,citation_publication_date=2019-07;,citation_cover_date=2019-07;,citation_year=2019;,citation_doi=10.1186/s13617-019-0085-5;,citation_volume=8;,citation_journal_title=Journal of Applied Volcanology;">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Integrative Analysis of Multi-omic Data</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p>Piero Palacios Bernuy <a href="mailto:p.palacios.bernuy@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-6729-4080" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
                      </div>
          </div>
                
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">May 1, 2024</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>This document is part of a series of the analysis of Omics data. Especifically, here is showed how to analyze bulk RNA-Seq data with Bioconductor packages. Also, it’s showcased how to make plots of the RNA data in the context of differentially gene expression and gene-sets.</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>Genomic Ranges, Omics, Bioconductor</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#gwas-catalog-with-a-chip-seq-experiment" id="toc-gwas-catalog-with-a-chip-seq-experiment" class="nav-link" data-scroll-target="#gwas-catalog-with-a-chip-seq-experiment"><span class="header-section-number">2</span> GWAS Catalog with a ChIP-Seq Experiment</a></li>
  <li><a href="#explore-the-tcga" id="toc-explore-the-tcga" class="nav-link" data-scroll-target="#explore-the-tcga"><span class="header-section-number">3</span> Explore the TCGA</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">4</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="index-preview.html"><i class="bi bi-journal-code"></i>Article Notebook</a></li><li><a href="notebooks/ENCODE-preview.html"><i class="bi bi-journal-code"></i>ENCODE Data Analysis</a></li><li><a href="notebooks/TCGA-preview.html"><i class="bi bi-journal-code"></i>Integrative Analysis with TCGA Data</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
</section>
<section id="gwas-catalog-with-a-chip-seq-experiment" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="gwas-catalog-with-a-chip-seq-experiment"><span class="header-section-number">2</span> GWAS Catalog with a ChIP-Seq Experiment</h2>
<p>Here, we are gonna analyze the relation between transcription factor binding (ESRRA binding data) from a ChIP-Seq experiment and the genome-wide associations between DNA variants and phenotypes like diseases. For this task, we are gonna use a the <code>gwascat</code> package distributed by the <strong>EMBL</strong> (European Molecular Biology Laboratories).</p>
<p>First, we need to download the data, keep the 24 chromosomes (from 1 to Y) and, specify the sequence information from the GRCh38 human genome annotation.</p>
<p>Now, let’s plot a karyogram that will show the SNP’s identified with significant associations with a phenotype. The SNP’s in the GWAS catalog have a stringent criterion of significance and there has been a replication of the finding from a independent population.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-1" href="index-preview.html">Source: Article Notebook</a></div>
<p>We can see the peak data as a <code>GRanges</code> object:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>GRanges object with 1873 ranges and 7 metadata columns:
         seqnames            ranges strand |      name     score       col
            &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;integer&gt; &lt;logical&gt;
     [1]     chrX   1509355-1512462      * |         5         0      &lt;NA&gt;
     [2]     chrX 26801422-26802448      * |         6         0      &lt;NA&gt;
     [3]    chr19 11694102-11695359      * |         1         0      &lt;NA&gt;
     [4]    chr19   4076893-4079276      * |         4         0      &lt;NA&gt;
     [5]     chr3 53288568-53290767      * |         9         0      &lt;NA&gt;
     ...      ...               ...    ... .       ...       ...       ...
  [1869]    chr19 11201120-11203985      * |      8701         0      &lt;NA&gt;
  [1870]    chr19   2234920-2237370      * |       990         0      &lt;NA&gt;
  [1871]     chr1 94311336-94313543      * |      4035         0      &lt;NA&gt;
  [1872]    chr19 45690614-45691210      * |     10688         0      &lt;NA&gt;
  [1873]    chr19   6110100-6111252      * |      2274         0      &lt;NA&gt;
         signalValue    pValue    qValue      peak
           &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;integer&gt;
     [1]      157.92   310.000        32      1991
     [2]      147.38   310.000        32       387
     [3]       99.71   311.660        32       861
     [4]       84.74   310.000        32      1508
     [5]       78.20   299.505        32      1772
     ...         ...       ...       ...       ...
  [1869]        8.65     7.281   0.26576      2496
  [1870]        8.65    26.258   1.99568      1478
  [1871]        8.65    12.511   1.47237      1848
  [1872]        8.65     6.205   0.00000       298
  [1873]        8.65    17.356   2.01323       496
  -------
  seqinfo: 93 sequences (1 circular) from hg19 genome</code></pre>
</div>
</div>
<p>If we see the bottom of the <code>GRanges</code> table, this experiment have the hg19 annotation from the human genome. To work on the GRCh38 annotation we need to lift-over with a <code>.chain</code> file. For this we can use the <code>AnnotationHub</code> package.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>AnnotationHub with 1 record
# snapshotDate(): 2023-10-23
# names(): AH14150
# $dataprovider: UCSC
# $species: Homo sapiens
# $rdataclass: ChainFile
# $rdatadateadded: 2014-12-15
# $title: hg19ToHg38.over.chain.gz
# $description: UCSC liftOver chain file from hg19 to hg38
# $taxonomyid: 9606
# $genome: hg19
# $sourcetype: Chain
# $sourceurl: http://hgdownload.cse.ucsc.edu/goldenpath/hg19/liftOver/hg19To...
# $sourcesize: NA
# $tags: c("liftOver", "chain", "UCSC", "genome", "homology") 
# retrieve record with 'object[["AH14150"]]' </code></pre>
</div>
</div>
<p>We can find overlaps between the GWAS catalog and the ESRRA ChIP-Seq experiment but, there is a problem; the GWAS catalog is a collection of intervals that reports all significant SNPs and there can be duplications of SNPs associated to multiple phenotypes or the same SNP might be found for the same phenotype in different studies.</p>
<p>We can see the duplications with the <code>reduce</code> function from <code>IRanges</code> package:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 261160</code></pre>
</div>
</div>
<p>We can see that there are <code>261160</code> duplicated loci. Let’s find the overlap between the <em>reduced</em> catalog and the ChIP-Seq experiment:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Hits object with 613 hits and 0 metadata columns:
        queryHits subjectHits
        &lt;integer&gt;   &lt;integer&gt;
    [1]         6      237757
    [2]         9      221130
    [3]        12       25060
    [4]        15      104699
    [5]        15      104700
    ...       ...         ...
  [609]      1928      246305
  [610]      1929      244698
  [611]      1929      244699
  [612]      1931      250380
  [613]      1931      250381
  -------
  queryLength: 1932 / subjectLength: 268560</code></pre>
</div>
</div>
<p>We can see 613 hits. Then, we are gonna eobtain the ranges from those hits, retrieve the phenotypes (DISEASE/TRAIT) and show the top 20 most common phenotypes with association to SNPs that lies on the ESRRA binding peaks.</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-4a05fa719059fd20d190" style="width:100%;height:400px;"></div>
<script type="application/json" data-for="htmlwidget-4a05fa719059fd20d190">{"x":{"data":[{"orientation":"v","width":7,"base":0.55000000000000004,"x":[3.5],"y":[0.89999999999999991],"text":"n:  7<br />value: Appendicular lean mass<br />value: Appendicular lean mass","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(232,236,251,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Appendicular lean mass","legendgroup":"Appendicular lean mass","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":1.55,"x":[3.5],"y":[0.90000000000000013],"text":"n:  7<br />value: Diastolic blood pressure<br />value: Diastolic blood pressure","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(221,216,239,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Diastolic blood pressure","legendgroup":"Diastolic blood pressure","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":2.5499999999999998,"x":[3.5],"y":[0.90000000000000036],"text":"n:  7<br />value: Educational attainment<br />value: Educational attainment","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(209,193,225,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Educational attainment","legendgroup":"Educational attainment","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":3.5499999999999998,"x":[3.5],"y":[0.90000000000000036],"text":"n:  7<br />value: Lymphocyte count<br />value: Lymphocyte count","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(195,168,209,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Lymphocyte count","legendgroup":"Lymphocyte count","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":4.5499999999999998,"x":[3.5],"y":[0.90000000000000036],"text":"n:  7<br />value: Mean spheric corpuscular volume<br />value: Mean spheric corpuscular volume","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(181,143,194,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Mean spheric corpuscular volume","legendgroup":"Mean spheric corpuscular volume","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":5.5499999999999998,"x":[3.5],"y":[0.90000000000000036],"text":"n:  7<br />value: Monocyte count<br />value: Monocyte count","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(167,120,180,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Monocyte count","legendgroup":"Monocyte count","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":6.5499999999999998,"x":[3.5],"y":[0.90000000000000036],"text":"n:  7<br />value: Plateletcrit<br />value: Plateletcrit","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(155,98,167,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Plateletcrit","legendgroup":"Plateletcrit","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":7.5499999999999998,"x":[3.5],"y":[0.89999999999999947],"text":"n:  7<br />value: Reticulocyte fraction of red cells<br />value: Reticulocyte fraction of red cells","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(140,78,153,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Reticulocyte fraction of red cells","legendgroup":"Reticulocyte fraction of red cells","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":8.5500000000000007,"x":[3.5],"y":[0.89999999999999858],"text":"n:  7<br />value: Rheumatoid arthritis<br />value: Rheumatoid arthritis","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(111,76,155,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Rheumatoid arthritis","legendgroup":"Rheumatoid arthritis","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":9.5500000000000007,"x":[3.5],"y":[0.89999999999999858],"text":"n:  7<br />value: Triglyceride levels<br />value: Triglyceride levels","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(96,89,169,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Triglyceride levels","legendgroup":"Triglyceride levels","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":7,"base":10.550000000000001,"x":[3.5],"y":[0.89999999999999858],"text":"n:  7<br />value: Type 2 diabetes<br />value: Type 2 diabetes","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(85,104,184,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Type 2 diabetes","legendgroup":"Type 2 diabetes","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":8,"base":11.550000000000001,"x":[4],"y":[0.89999999999999858],"text":"n:  8<br />value: Heel bone mineral density<br />value: Heel bone mineral density","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(78,121,197,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Heel bone mineral density","legendgroup":"Heel bone mineral density","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":8,"base":12.550000000000001,"x":[4],"y":[0.89999999999999858],"text":"n:  8<br />value: Systolic blood pressure<br />value: Systolic blood pressure","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(77,138,198,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Systolic blood pressure","legendgroup":"Systolic blood pressure","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":9,"base":13.550000000000001,"x":[4.5],"y":[0.89999999999999858],"text":"n:  9<br />value: Sex hormone-binding globulin levels<br />value: Sex hormone-binding globulin levels","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(78,150,188,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Sex hormone-binding globulin levels","legendgroup":"Sex hormone-binding globulin levels","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":10,"base":14.550000000000001,"x":[5],"y":[0.89999999999999858],"text":"n: 10<br />value: Eosinophil counts<br />value: Eosinophil counts","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(84,158,179,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Eosinophil counts","legendgroup":"Eosinophil counts","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":10,"base":15.550000000000001,"x":[5],"y":[0.89999999999999858],"text":"n: 10<br />value: HDL cholesterol levels<br />value: HDL cholesterol levels","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,165,169,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"HDL cholesterol levels","legendgroup":"HDL cholesterol levels","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":10,"base":16.550000000000001,"x":[5],"y":[0.89999999999999858],"text":"n: 10<br />value: Hematocrit<br />value: Hematocrit","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(96,171,158,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Hematocrit","legendgroup":"Hematocrit","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":10,"base":17.550000000000001,"x":[5],"y":[0.89999999999999858],"text":"n: 10<br />value: Platelet count<br />value: Platelet count","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(105,177,144,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Platelet count","legendgroup":"Platelet count","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":10,"base":18.550000000000001,"x":[5],"y":[0.89999999999999858],"text":"n: 10<br />value: Total cholesterol levels<br />value: Total cholesterol levels","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(119,183,125,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Total cholesterol levels","legendgroup":"Total cholesterol levels","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":10,"base":19.550000000000001,"x":[5],"y":[0.89999999999999858],"text":"n: 10<br />value: Waist-to-hip ratio adjusted for BMI<br />value: Waist-to-hip ratio adjusted for BMI","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(140,188,104,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Waist-to-hip ratio adjusted for BMI","legendgroup":"Waist-to-hip ratio adjusted for BMI","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":10,"base":20.550000000000001,"x":[5],"y":[0.89999999999999858],"text":"n: 10<br />value: White blood cell count<br />value: White blood cell count","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(166,190,84,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"White blood cell count","legendgroup":"White blood cell count","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":11,"base":21.550000000000001,"x":[5.5],"y":[0.89999999999999858],"text":"n: 11<br />value: High density lipoprotein cholesterol levels<br />value: High density lipoprotein cholesterol levels","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,188,72,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"High density lipoprotein cholesterol levels","legendgroup":"High density lipoprotein cholesterol levels","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":13,"base":22.550000000000001,"x":[6.5],"y":[0.89999999999999858],"text":"n: 13<br />value: Multi-trait sex score<br />value: Multi-trait sex score","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(209,181,65,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Multi-trait sex score","legendgroup":"Multi-trait sex score","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":14,"base":23.550000000000001,"x":[7],"y":[0.89999999999999858],"text":"n: 14<br />value: Body mass index<br />value: Body mass index","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(221,170,60,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Body mass index","legendgroup":"Body mass index","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":15,"base":24.550000000000001,"x":[7.5],"y":[0.89999999999999858],"text":"n: 15<br />value: Red cell distribution width<br />value: Red cell distribution width","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,156,57,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Red cell distribution width","legendgroup":"Red cell distribution width","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":16,"base":25.550000000000001,"x":[8],"y":[0.89999999999999858],"text":"n: 16<br />value: Mean corpuscular volume<br />value: Mean corpuscular volume","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(231,140,53,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Mean corpuscular volume","legendgroup":"Mean corpuscular volume","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":18,"base":26.550000000000001,"x":[9],"y":[0.89999999999999858],"text":"n: 18<br />value: Red blood cell count<br />value: Red blood cell count","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(230,121,50,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Red blood cell count","legendgroup":"Red blood cell count","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":25,"base":27.550000000000001,"x":[12.5],"y":[0.89999999999999858],"text":"n: 25<br />value: Mean corpuscular hemoglobin<br />value: Mean corpuscular hemoglobin","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(228,99,45,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Mean corpuscular hemoglobin","legendgroup":"Mean corpuscular hemoglobin","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":48,"base":28.550000000000001,"x":[24],"y":[0.89999999999999858],"text":"n: 48<br />value: Height<br />value: Height","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(223,72,40,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Height","legendgroup":"Height","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":276.89497716894988},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.4000000000000004,50.399999999999999],"tickmode":"array","ticktext":["0","10","20","30","40","50"],"tickvals":[0,10,20,30,40,50],"categoryorder":"array","categoryarray":["0","10","20","30","40","50"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"n","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,29.600000000000001],"tickmode":"array","ticktext":["Appendicular lean mass","Diastolic blood pressure","Educational attainment","Lymphocyte count","Mean spheric corpuscular volume","Monocyte count","Plateletcrit","Reticulocyte fraction of red cells","Rheumatoid arthritis","Triglyceride levels","Type 2 diabetes","Heel bone mineral density","Systolic blood pressure","Sex hormone-binding globulin levels","Eosinophil counts","HDL cholesterol levels","Hematocrit","Platelet count","Total cholesterol levels","Waist-to-hip ratio adjusted for BMI","White blood cell count","High density lipoprotein cholesterol levels","Multi-trait sex score","Body mass index","Red cell distribution width","Mean corpuscular volume","Red blood cell count","Mean corpuscular hemoglobin","Height"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29],"categoryorder":"array","categoryarray":["Appendicular lean mass","Diastolic blood pressure","Educational attainment","Lymphocyte count","Mean spheric corpuscular volume","Monocyte count","Plateletcrit","Reticulocyte fraction of red cells","Rheumatoid arthritis","Triglyceride levels","Type 2 diabetes","Heel bone mineral density","Systolic blood pressure","Sex hormone-binding globulin levels","Eosinophil counts","HDL cholesterol levels","Hematocrit","Platelet count","Total cholesterol levels","Waist-to-hip ratio adjusted for BMI","White blood cell count","High density lipoprotein cholesterol levels","Multi-trait sex score","Body mass index","Red cell distribution width","Mean corpuscular volume","Red blood cell count","Mean corpuscular hemoglobin","Height"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"value","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"value","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4e2c3e18d6b":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"4e2c3e18d6b","visdat":{"4e2c3e18d6b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Distinct phenotypes identified on the peaks:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 613</code></pre>
</div>
</div>
<p>Now, how to do the inference of these phenotype on peaks of these b cells? We can use permutation on the genomic positions to test if the number of phenotypes found is due to chance or not.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="explore-the-tcga" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="explore-the-tcga"><span class="header-section-number">3</span> Explore the TCGA</h2>
<p>Please check the dedicated script (top left) to see how to explore and get insights from the TCGA (The Cancer Genome Atlas) database.</p>
</section>
<section id="conclusion" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">4</span> Conclusion</h2>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" role="list">

</div>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{palacios_bernuy2024,
  author = {Palacios Bernuy, Piero},
  title = {Integrative {Analysis} of {Multi-omic} {Data}},
  date = {2024-05-01},
  langid = {en},
  abstract = {This document is part of a series of the analysis of Omics
    data. Especifically, here is showed how to analyze bulk RNA-Seq data
    with Bioconductor packages. Also, it’s showcased how to make plots
    of the RNA data in the context of differentially gene expression and
    gene-sets.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-palacios_bernuy2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Palacios Bernuy, Piero. 2024. <span>“Integrative Analysis of Multi-Omic
Data.”</span> An Open Source Portfolio. May 1, 2024.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","openEffect":"zoom","descPosition":"bottom","loop":false,"closeEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>